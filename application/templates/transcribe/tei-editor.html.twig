{% set canValidate = media.project | isAuthorizedOnProject('validateTranscription') %}
{% set canViewLogs = media.project | isAuthorizedOnProject('viewLogs') %}
{% set transcription = media.transcription %}
{% set comments = transcription.comments %}
<ul class="nav nav-tabs nav-fill">
  {% if edit %}
  <li class="nav-item">
    <a data-intro="{{'help4'|trans}}" data-step="4" class="nav-link active" data-position="top" data-toggle="tab" href="#edit-full">{{'transcribe'|trans}}</a>
  </li>
  {% endif %}
  <li class="nav-item" data-intro="{{'help5'|trans}}" data-step="5">
    <a class="nav-link {% if not edit %}active{% endif %}" data-toggle="tab"  href="#preview">{{'preview'|trans}}</a>
  </li>

  <li class="nav-item" data-intro="{{'help6'|trans}}" data-step="6">
    <a class="nav-link" data-toggle="tab"  href="#comments">{{'comments'|trans}} ({{comments|length}})</a>
  </li>
  {% if canValidate %}
  <li class="nav-item" data-intro="{{'help7'|trans}}" data-step="7">
    <a class="nav-link" data-toggle="tab"  href="#reviews">{{'reviews'|trans}}</a>
  </li>
  {% endif %}

  <li class="nav-item" data-intro="{{'help8'|trans}}" data-step="8">
    <a class="nav-link" data-toggle="tab" href="#help-full">{{'help'|trans}}</a>
  </li>


  {% if canViewLogs %}
  <li class="nav-item">
    <a class="nav-link" data-toggle="tab"  href="#logs">{{'logs'|trans}}</a>
  </li>
  {% endif %}
</ul>
<div class="tab-content transcription-panel-content">
  {% if edit %}
  <div id="edit-full" class="tab-pane fade show active" role="tabpanel">
    <div class="row">
      <div class="col">
        <textarea class="tinymce-transcription" id="tiny-content" name="transcription-content" rows="20" cols="60">
          {{ transcription.content | raw }}
        </textarea>
      </div>
      {% if project.hasScheme %}
      <div class="col-3 selected-element">
        <div class="row">
          <div class="col">
            <div class="card element-attributes-container">
              <div class="card-header">
                <span class="text-muted">{{'attributes'|trans}}</span>
                <span class="element-title"></span>
                <span class="btn btn-sm btn-outline-secondary" data-toggle="collapse" data-target="#element-attributes">
                  <i class="fas fa-arrows-alt-v"></i> Afficher/masquer 
                </span>
              </div>
              <ul id="element-attributes" class="list-group list-group-flush element-attributes collapse show"></ul>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col">
            <div class="card elements-container">
              <div class="card-header">
                <div class="input-group input-group-sm">
                  <div class="input-group-prepend">
                    <span class="input-group-text">
                      <i class="fas fa-search"></i>
                    </span>
                  </div>
                  <input type="text" class="form-control filter-elements" placeholder="{{'element_list'|trans}}" name="" value="" />
                </div>
              </div>
              <ul class="list-group list-group-flush elements"></ul>
            </div>
          </div>
        </div>
      </div>
      {% endif %}
    </div>
  </div>
  {% endif %}
  <div id="preview" class="tab-pane fade {% if not edit %}show active{% endif %}" role="tabpanel">
    {{ transcription.content | raw}}
  </div>
  <div id="comments" class="tab-pane fade" role="tabpanel">
    {% if app.user %}
    {{ include('comments/create.html.twig') }}
    {% endif %}
    {{ include('comments/list.html.twig') }}
  </div>
  <div id="help-full" class="tab-pane fade" role="tabpanel">
    {{ include ('transcribe/help.html.twig') }}
  </div>
  {% if canValidate %}
  <div id="reviews" class="tab-pane fade" role="tabpanel">
    {{ include('review/list.html.twig') }}
  </div>
  {% endif %}
  {% if canViewLogs %}
  <div id="logs" class="tab-pane fade" role="tabpanel">
    {{ include('log/list.html.twig') }}
  </div>
  {% endif %}

  <input type="hidden" id="tei-schema" name="tei_schema" value="{{schema}}">
</div>
